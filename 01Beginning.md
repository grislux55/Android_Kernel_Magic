# 一、入门简介

`注意！！！由于本文主要探讨Android内核，因此后续文字如不额外说明，均认为内核指代的是Android内核！！！`

## 介绍

### 一、内核的概念

- 问题一：

    > 内核是啥？

- 解答：

    > 内核，是Android系统中贴近底层（或者说就是底层）的一个组件。它就像汽车的基础框架，铅笔的芯，大楼的地基。

- 问题二：

    > 为什么要修改内核？

- 解答：

    > 内核的稳固程度直接或间接地影响了整个Android系统的稳定性，内核的优化程度的高低可以一定程度上影响性能，也可以对续航造成影响。甚至由于在底层的原因，一行代码带来的优化，可能被放大几十上百倍。内核的各项指标几乎标定了一部分系统数据，在不改动内核的情况下，某些东西是不可能在系统层面实现的。

- 问题三：

    > 既然内核有这么重要的作用，那为什么官方不优化好呢？

- 解答：

    > 因为（~~他们要加广告~~）代码的后向兼容性（~~产品经理的需求不定向性~~）等原因。这些针对于某些特定情况下的内核补丁可能会对未来的某些功能造成破坏。比如说主代码有一个新功能的提交，但是某些优化分支进行魔改的时候引入了一个更改导致该设备代码合并不起来，那么这个程序员的泡妞时间（~~休想~~）就会减少，毕竟他要去解决合并问题嘛，再说官方程序员一天到晚事也多（~~996算什么，你可知道007？~~），如果一个微不足道的优化会导致休息时间变少，他们肯定是不愿意的。但是第三方开发者维护的内核就不会这样。（~~毕竟人家就是在用泡妞时间给你搞内核~~）

- 问题四：

    > 第三方内核一定就比官方好吗？

- 解答：

    > 当然......不是。不同的内核由不同（也有可能是相同的不过很少有开发者这么闲）的开发者维护，不同的开发者功力各不相同，有些（~~像我一样~~）水平不好的开发者搞了一堆稀烂的代码弄出来的内核就会很崩。
***所以不要盲目真香。***
再者，由于内核的特殊性，如果内核里面有恶意代码，会被以极高的权限执行。而且某些性能优化也会导致安全性的降低，所以请尽可能选择信任的开发者所制作的内核。

### 二、编译器有关的概念
- 问题一：

    > 什么是GCC，什么是Clang，它们之间有什么区别？

- 解答：

    > GCC是GNU（GNU's Not Unix）的一个编译器套件（GNU Compiler Collection），它包括了C、C++、Objective-C、Fortran、Java、Ada和Go语言的前端，也包括了这些语言的库（如libstdc++、libgcj等等）。Clang是隶属于LLVM项目下的一个C语言、C++、Objective-C语言的轻量级编译器。《——百度百科》
对于我们来说，它们之间最大的区别在于GCC编译器区分平台打包，编译时需要使用对应平台的编译器；Clang编译器不分平台，编译时只需使用-target指定平台。Android官方目前墙裂推荐将Clang作为Android项目的编译器。

- 问题二：

    > 什么是交叉编译工具链？

- 解答：

    > 交叉编译工具链是在一个平台上编译输出另一个平台上应用程序的一整套工具（不只是编译器，还有很多其他工具）。（放宽心态，虽然Android也是一种Linux但是因为芯片的不同这也算跨平台。）

- 问题三：

    > GCC和Clang的性能有什么区别吗？

- 解答：

    > 当然有区别，Clang编译套件是组件化的，由Clang编译器前端分发优化下的LLVM IR，再由LLVM后端进行更细致的优化处理，最终生成汇编。GCC内部则是直接生成到汇编。所以GCC的编译时占用通常要比Clang的要高，当然，凡事也没有个绝对，当Clang开启LTO（链接时优化）的时候，因为要读入所有的LLVM IR，所以占用会达到一个惊人的数值。对于生成的代码，其性能在不同的情况下有着不同的表现，一般情况下的Clang直接编译的性能是比不上GCC的，但是开启LTO，polly之类的优化之后又能略微超出。

- 问题四：

    > 那推荐使用哪个编译器呢？

- 解答：

    > 仁者见仁智者见智，由于Clang的软件分发的方式，有时会破坏掉内核代码的生成，但是GCC编译内核时产出的警告非常多，也不利于查看输出。一般来说跟着谷歌走没有什么太大问题。

